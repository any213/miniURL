# mini URL

긴 URL 주소를 짧게 줄여 편리함을 제공하는 웹 어플리케이션 입니다.

## 실행에 필요한 환경 설정

### 1. 환경
> OSX,Linux

### 2. Python 설치
Python3 및 실행에 필요한 패키지 설치가 필요합니다.\
*python3
>https://www.python.org/downloads/release/python-365/
>
*flask
>https://pypi.org/project/Flask/1.0.2/
>
*redis (python redis client)
>https://pypi.org/project/redis/

### 3. config 설정
miniURL/setup/config.json 파일을 통하여 어플리케이션 설정값을 셋팅합니다.
>1. db_type\
사용할 데이터 베이스 종류를 지정합니다.
>2. app\
구동할 어플리케이션 설정을 지정합니다.
>3. log\
로깅 정보 설정
>4. cache\
캐시 사용 여부 및 장비 정보 설정
현재 레디스만 지원합니다.
>5. redis, mongo\
db_type 에 맞는 각 데이터베이스 장비 정보 설정


## 실행하기

>cd miniURL\
>python3 main.py



## 단위 테스트

python unittest 모듈을 통한 단위 테스트가 가능하며,
miniURL/tests/tester.py 에 일부 테스트 유닛이 작성되어있습니다.

> cd tesets\
>python3 -m unittest tester.py 

## 문제 해결 전략

### 요구사항

#### * webapp으로 개발하고 URL 입력폼 제공 및 결과 출력
flask 를 이용하여 웹 어플리케이션을 만들었고, html로 입력폼 제공 및 결과 출력


#### * URL Shortening Key는 8 Character 이내로 생성
직접 만든 해싱 알고리즘을 통해 생성한 해시 값 중 base62 인코딩을 통하여 8char 이내로 생성되도록 설계

#### * 동일한 URL에 대한 요청은 동일한 Shortening Key로 응답
해시 알고리즘은 url 입력 데이터를 기반으로 해싱을 하게 되어있기 때문에
동일한 값 리턴. 또, 데이터 베이스에 생성된 정보들을 저장하고 있기 때문에 동일한 url 에 대해서는 동일한 값 리턴 

#### * Shortening된 URL을 요청받으면 원래 URL로 리다이렉트
요청받은 짧은 url 에 대하여 실제 원본 url 로 리다이렉트 되도록 구현

#### * Shortening Key 생성 알고리즘 직접 구현 (라이브러리 사용 불가)
라이브러리를 사용하지 않고서 직접 구현하려면, 알고리즘을 코드로 그대로 옮겨 사용하는 것이 아니라 해당 알고리즘에 대하여 명확한 이해를 기반으로 구현하는 것이 필요하다고 판단. 이미 검증되어 널리 사용중인 sha3 등의 알고리즘은 기간내에 할 수 없다고 판단되어 자체 알고리즘을 구현하였습니다. \
알고리즘 로직 : 정해둔 소수값을 왼쪽 5번 쉬프트 (2의5승) 연산을 수행하며 자기자신을 더하고, 매 연산마다 해싱할 문자열의 문자 1개씩을 덧붙여 연산하여 충돌을 최소화 할 수 있는 소수 값이 최대한 나오도록 계산. 해싱할 문자열은 요청 받은 원본 url에 서버 내부에 지정되어있는 특정 문자열 값을 섞은 값으로 도출

#### * Database 사용은 필수 아님 (선택)
사용이 필수는 아니었지만, 해싱 알고리즘으로 계산될 해시 값의 충돌 가능성을 배제할 수 없기 때문에 충돌시의 새로운 해시 값 생성을 위하여 원본 url 과 줄인 url 의 맵핑정보 값을 보관하도록 하였습니다. 현재는 redis를 데이터 베이스로 사용할 수 있게 구현 되어있고, db 인터페이스를 이용하여 다른 데이터 베이스를 사용하더라도 해당 로직만 작성하면 사용 가능하게 되어있습니다.

## TDL
* 안정성 및 성능을 위하여 레디스가 아닌 디스크 기반 데이터 베이스 사용 필요
* 파이썬 언어 자체의 특징인 GIL로 인한 성능을 고려하여, 추후 병행성을 고려한 고도화 필요
* 해싱 알고리즘에 대한 검증 및 기존 존재하는 다른 알고리즘에 대한 리서치 필요
* 빠른 배포를 위한 스크립트 작성 이용
